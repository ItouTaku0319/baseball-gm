# タスクリスト

## 完了済み
- [x] NPB風143試合スケジュール（同リーグ25試合×5 + 交流戦3試合×6）
- [x] パワプロ風成績ページ（タイトル争い・打撃/投手テーブル・セイバー指標）
- [x] ダッシュボードのセパ分割順位表・GM視点シム操作パネル
- [x] 全ページUX改善（tabular-nums・ストライプ・ホバー・能力値色分け）

## 基本ステータスの見直し
- ミート、パワー、走力、肩力、守備力、捕球の基本ステータス（1~100刻み？）
- 守備位置、選球眼、潜在等は生かせるか？
- 投手は球速を150kmなどの実数表記にする
- 投手: 制球、変化球（パワプロ風に変化量を設定する。プロスピは球威と変化量で分かれているがどう扱うか検討）、スタミナ、精神、潜在
- 投手にも守備力が必要

## 選手起用・オーダー設定
- 先発ローテーション、中継ぎ、抑えの設定
- ベストオーダー設定
- 野手起用法: 守備固め、代打、代走、途中交代
- 投手起用法: 勝利投手条件、スタミナ限界、中継ぎエース、敗戦処理、リード時、守護神

## ドラフト機能（UIの実装）
- エンジンは `src/engine/draft.ts` に実装済み
- ドラフト画面UIの構築
- ウェーバー方式の選手指名フロー

## トレード機能（UIの実装）
- エンジンは `src/engine/trade.ts` に実装済み
- トレード画面UIの構築
- 選手価値の表示、交渉フロー

## 1,2,3軍・育成選手の追加
- 軍の概念を追加
- 育成選手枠

## 外国人助っ人の追加
- 外国人枠の制限
- 助っ人選手の生成・獲得

## サブポジションの実装
- 複数ポジション対応
- ポジション適性の表示

## 特殊能力の実装
- どこまで行うか検討が必要
- パワプロ風の特殊能力？

## 年齢による衰え
- 年齢によるステータス変動
- ピーク年齢の設定

## けが・大けがの実装
- 試合中の故障発生
- 離脱期間の設定

## FA・海外進出
- FA宣言・交渉
- 海外移籍（MLB等）

## 財務システム
- チーム強さ → ファン数増減 → シーズンオフ収入変動
- 選手年俸の設定・交渉
- どこまで複雑にするか検討が必要

## 練習設定
- 練習メニューの設定
- 選手成長への影響

---


## シミュレーション守備改修＋守備・投手指標の追加
現在のシミュレーションは守備がほぼ未実装。打球処理・守備位置の概念を入れて、守備指標と投手の打球系指標を追加する。

### Step 1: 打球処理の基盤整備（simulation.ts 改修）
- 打球に種類を持たせる（内野ゴロ / 内野フライ / 外野フライ / ライナー等）
- 打者のパワー・ミートと投手の球種から打球種類の確率を決定
- 守備位置に応じて処理する野手を決める
- fielding / catching / arm を使ってアウト成功率・エラー率を計算
- 盗塁の実装（走力 vs 捕手肩力）
- ダブルプレーの実装（走者＋内野ゴロ時）

### Step 2: 守備成績の記録（モデル追加）
- 選手ごとに刺殺(PO)、補殺(A)、失策(E) を記録
- PlayerGameStats に守備フィールドを追加
- 守備率 = (PO+A) / (PO+A+E)
- レンジファクター = (PO+A) / 試合数

### Step 3: 守備指標（UZR等）
- 簡易UZR: 守備位置の平均対比で守備貢献ランを算出
- DRS (Defensive Runs Saved) も同様のアプローチで
- 成績ページに守備指標タブ/列を追加

### Step 4: 投手の打球系指標
- GB% (ゴロ率)、FB% (フライ率)、LD% (ライナー率)
- GB/FB 比率
- IFFB% (内野フライ率)
- HR/FB (フライに対する本塁打率)
- 成績ページの投手セイバー指標に追加

### 備考
- Step 1 が最も工数が大きい（simulation.ts の大幅改修）
- Step 2-4 は Step 1 の上に乗せる形なので比較的軽い
- 能力値 fielding / catching / arm は既にモデルに定義済み（野手・投手とも）

## 球種のビジュアル表示（保留）
- 現在はテーブル内テキスト表示（球種名+変化量）で仮実装
- パワプロ風のグラフィカル表示を検討したが、テーブルセル内に収まるサイズでは見づらかった
  - ブロック/セグメント式（5方向矢印）→ テーブル行が巨大化して一覧性が悪い
  - ラジアルドットチャート（test.jsx）→ コンパクトにすると文字が潰れて見づらい
- test.jsx にラジアルチャートの参考実装あり。選手詳細画面など広いスペースで使えるかも
- 今後の方向性: 選手個別詳細ページを作ったときにそこで使う、またはホバー/クリックポップアップで別途検討

## PMからの提案
<!-- PMが実装中に気づいた課題・改善点をここに追記する -->
<!-- 人間が確認して正式タスクに昇格させるか、却下する -->

