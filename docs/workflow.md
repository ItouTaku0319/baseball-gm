# 開発ワークフロー詳細

## スプリント制（2-3日サイクル）

```
スプリント開始 → /sprint plan でバックログから選定 → GM承認
作業中         → タスクを実行（下記参照）
スプリント終了 → /sprint done で振り返り → 次スプリント計画
```

## タスク実行の流れ

```
1. タスクの規模を判断
   小 (数行〜30行)    → PMタブで直接実装
   中 (30〜100行)     → /delegate でサブエージェントに委譲
   大 (100行+、新ファイル) → 別タブに指示を投入

2. 別タブへの指示テンプレート
   ■ やること: 〇〇を実装して
   ■ 読むべきドキュメント: CLAUDE.md, docs/xxx.md, plan.txt
   ■ 完了条件: build成功, テスト通過, バランステスト通過
   ■ やらないこと: スコープ外の変更を明記

3. 結果確認
   /review で変更内容をレビュー
   問題なければ「コミットして」

4. 次のタスクへ
```

## カスタムコマンド

| コマンド | 用途 |
|---------|------|
| `/sprint` | スプリント状況確認・計画・振り返り |
| `/sprint plan` | 次のスプリントを計画（バックログから選定） |
| `/sprint done` | スプリント振り返り + 次の計画 |
| `/delegate <タスク>` | タスクを適切なサブエージェントに委譲 |
| `/review` | 直近の変更をレビュー（別タブの実装結果確認） |

## 3タブ運用

```
左(縦長): PMタブ（常駐）
  → 計画・相談・小中タスク・進捗管理・コミット
右上: 実装タブA（必要時のみ）
  → 大規模タスク（守備AI書き換え等）
右下: 実装タブB（必要時のみ）
  → もう1つの大タスク（打球生成再設計等）
```

- 右のタブは大タスクがある時だけ開く。終わったら閉じてOK
- 同時に2つの大タスクを並行する時だけ3タブ使う
- 普段はPMタブ + 実装1タブで十分

## 役割分担

| 役割 | 誰 | やること |
|------|-----|---------|
| GM/PO | あなた | 方針決定、優先度判断、承認 |
| PM | Claude (PMタブ) | 設計、タスク分解、委譲、進捗管理、コミット |
| 実装 | サブエージェント or 別タブ | コード実装、テスト通過 |
| 検証 | tester/reviewer/guardian | 品質チェック（読み取り専用） |

## 判断のルール

| 状況 | ルール |
|------|--------|
| 実装していいか？ | バックログにあって完了条件が明確 → YES |
| テストが通らない | 3回リトライで直らない → 報告して中断 |
| 設計で合ってるか？ | NPB統計と比較して範囲内 → OK |
| スコープ外に気づいた | バックログに1行追加 → 今のタスクに戻る |

## 参照すべきドキュメント

| ファイル | 用途 |
|---------|------|
| `docs/project-map.md` | プロジェクト全体図・システム成熟度 |
| `docs/fielding-test-guide.md` | 守備AIのテスト手順・品質基準 |
| `docs/batted-ball-design-context.md` | 打球生成ロジック再設計の前提情報 |
